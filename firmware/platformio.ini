; =============================================================================
; PlatformIO Configuration - The Conveyor (T-IOT-901)
; Firmware unifié: RFID + Servo + GRBL + WiFi + API Dolibarr
; =============================================================================

[platformio]
default_envs = m5stack-core-esp32

; =============================================================================
; Environnement M5Stack (firmware réel)
; =============================================================================
[env:m5stack-core-esp32]
platform = espressif32@6.3.2
board = m5stack-core-esp32
framework = arduino
monitor_speed = 115200

; Options de build
build_flags =
  -D CORE_DEBUG_LEVEL=3

lib_deps =
  m5stack/M5Stack@^0.4.6
  bblanchon/ArduinoJson@^7.0.0

; =============================================================================
; Environnement Native (tests sur PC sans hardware)
; =============================================================================
[env:native]
platform = native
test_framework = unity
build_flags =
  -std=c++11
  -D UNIT_TEST
lib_ignore =
  M5Stack
  WiFi
  HTTPClient